# ğŸ“¦ èµ„æºç®¡ç†å™¨æ¶æ„è¯´æ˜

## ğŸ¯ æ¶æ„è®¾è®¡

### èŒè´£åˆ†ç¦»

1. **PreloadScene** - æ¸¸æˆå¯åŠ¨å‰çš„é¢„åŠ è½½
   - åªè´Ÿè´£åŠ è½½æ¸¸æˆå¯åŠ¨æ—¶**å¿…éœ€**çš„èµ„æº
   - é»˜è®¤è§’è‰²ï¼ˆmage_307ï¼‰
   - å‰3ç§æ€ªç‰©
   - æ­£åœ¨ä½¿ç”¨çš„ç‰¹æ•ˆ
   - ä¸åŒ…å«å»¶è¿ŸåŠ è½½é€»è¾‘

2. **ResourceManager** - æ¸¸æˆè¿‡ç¨‹ä¸­çš„èµ„æºç®¡ç†
   - è´Ÿè´£æ‰€æœ‰å»¶è¿ŸåŠ è½½çš„èµ„æº
   - è§’è‰²èµ„æºåŠ è½½
   - æ€ªç‰©èµ„æºåŠ è½½
   - ç»Ÿä¸€çš„èµ„æºç®¡ç†æ¥å£
   - èµ„æºç¼“å­˜å’ŒçŠ¶æ€æ£€æŸ¥

## ğŸ“‹ ResourceManager API

### åŸºæœ¬æ–¹æ³•

```typescript
// è®¾ç½®å½“å‰åœºæ™¯ï¼ˆç”¨äºèµ„æºåŠ è½½ï¼‰
ResourceManager.getInstance().setScene(scene);

// æ£€æŸ¥èµ„æºæ˜¯å¦å·²åŠ è½½
ResourceManager.getInstance().isCharacterLoaded(characterId);
ResourceManager.getInstance().isMonsterLoaded(difficulty);

// åŠ è½½å•ä¸ªè§’è‰²
await ResourceManager.getInstance().loadCharacter(characterId);

// åŠ è½½å•ä¸ªæ€ªç‰©
await ResourceManager.getInstance().loadMonster(difficulty);

// æ‰¹é‡åŠ è½½å¤šä¸ªè§’è‰²
await ResourceManager.getInstance().loadCharacters([id1, id2, ...]);
```

## ğŸ”„ ä½¿ç”¨ç¤ºä¾‹

### åœ¨ SkinShopScene ä¸­ä½¿ç”¨

```typescript
create(): void {
  // è®¾ç½®èµ„æºç®¡ç†å™¨åœºæ™¯
  ResourceManager.getInstance().setScene(this);
  
  // åˆ›å»ºç•Œé¢
  this.createSkinList();
  
  // å¼‚æ­¥åŠ è½½æ‰€æœ‰è§’è‰²èµ„æº
  this.loadAllCharactersForShop();
}

private async loadAllCharactersForShop(): Promise<void> {
  const resourceManager = ResourceManager.getInstance();
  const characters = getAllCharacters();
  
  const charactersToLoad = characters
    .filter(c => !resourceManager.isCharacterLoaded(c.id))
    .map(c => c.id);
  
  if (charactersToLoad.length > 0) {
    await resourceManager.loadCharacters(charactersToLoad);
    // æ›´æ–°é¢„è§ˆ
    charactersToLoad.forEach(id => {
      this.updateCharacterPreview(id);
    });
  }
}
```

### åœ¨ GamePlayScene ä¸­ä½¿ç”¨

```typescript
async create(): Promise<void> {
  // è®¾ç½®èµ„æºç®¡ç†å™¨åœºæ™¯
  ResourceManager.getInstance().setScene(this);
  
  // åŠ è½½è§’è‰²èµ„æº
  await this.createPrincess();
  
  // åŠ è½½æ€ªç‰©èµ„æº
  await this.createMonsters();
}

private async createPrincess(): Promise<void> {
  const characterId = DataManager.getInstance().getCurrentCharacter();
  const resourceManager = ResourceManager.getInstance();
  
  if (!resourceManager.isCharacterLoaded(characterId)) {
    await resourceManager.loadCharacter(characterId);
  }
  
  // åˆ›å»ºè§’è‰²
  this.princess = new Princess(this, x, y, characterId);
}
```

## âœ… ä¼˜åŠ¿

1. **èŒè´£æ¸…æ™°**ï¼šPreloadScene åªè´Ÿè´£å¯åŠ¨é¢„åŠ è½½ï¼ŒResourceManager è´Ÿè´£è¿è¡Œæ—¶åŠ è½½
2. **ç»Ÿä¸€æ¥å£**ï¼šæ‰€æœ‰åœºæ™¯ä½¿ç”¨ç›¸åŒçš„èµ„æºç®¡ç†æ¥å£
3. **æ˜“äºç»´æŠ¤**ï¼šèµ„æºåŠ è½½é€»è¾‘é›†ä¸­ç®¡ç†
4. **å¯æ‰©å±•**ï¼šæœªæ¥å¯ä»¥æ·»åŠ æ›´å¤šèµ„æºç±»å‹ï¼ˆéŸ³æ•ˆã€èƒŒæ™¯ç­‰ï¼‰

## ğŸ“ æ³¨æ„äº‹é¡¹

1. **åœºæ™¯åˆ‡æ¢**ï¼šæ¯æ¬¡è¿›å…¥æ–°åœºæ™¯æ—¶ï¼Œéœ€è¦è°ƒç”¨ `setScene()` è®¾ç½®å½“å‰åœºæ™¯
2. **èµ„æºç¼“å­˜**ï¼šå·²åŠ è½½çš„èµ„æºä¼šè¢« Phaser ç¼“å­˜ï¼Œä¸ä¼šé‡å¤åŠ è½½
3. **é”™è¯¯å¤„ç†**ï¼šåŠ è½½å¤±è´¥æ—¶ä¼šæŠ›å‡ºé”™è¯¯ï¼Œéœ€è¦é€‚å½“å¤„ç†

---

**æ¶æ„é‡æ„å®Œæˆï¼** ğŸ‰

